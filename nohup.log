creating transformer data
  0%|          | 0/203 [00:00<?, ?it/s]/Users/moon515/Documents/mpnst_smile_model/gnn_utils.py:253: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_new.cpp:278.)
  data = Data(tokens=torch.tensor([tokens], dtype=torch.long),
 40%|████      | 82/203 [00:00<00:00, 811.60it/s] 84%|████████▍ | 171/203 [00:00<00:00, 854.51it/s]100%|██████████| 203/203 [00:00<00:00, 830.21it/s]
creating transformer data
  0%|          | 0/3613 [00:00<?, ?it/s]  2%|▏         | 73/3613 [00:00<00:04, 725.42it/s]  4%|▍         | 153/3613 [00:00<00:04, 768.45it/s]  7%|▋         | 236/3613 [00:00<00:04, 795.41it/s]  9%|▉         | 318/3613 [00:00<00:04, 801.70it/s] 11%|█         | 406/3613 [00:00<00:03, 827.46it/s] 14%|█▎        | 495/3613 [00:00<00:03, 846.24it/s] 16%|█▌        | 584/3613 [00:00<00:03, 857.53it/s] 19%|█▊        | 674/3613 [00:00<00:03, 867.73it/s] 21%|██        | 761/3613 [00:00<00:03, 837.01it/s] 23%|██▎       | 848/3613 [00:01<00:03, 846.57it/s] 26%|██▌       | 937/3613 [00:01<00:03, 858.44it/s] 28%|██▊       | 1027/3613 [00:01<00:02, 869.91it/s] 31%|███       | 1117/3613 [00:01<00:02, 876.87it/s] 33%|███▎      | 1207/3613 [00:01<00:02, 881.23it/s] 36%|███▌      | 1296/3613 [00:01<00:02, 855.50it/s] 38%|███▊      | 1382/3613 [00:01<00:02, 822.39it/s] 41%|████      | 1466/3613 [00:01<00:02, 825.69it/s] 43%|████▎     | 1556/3613 [00:01<00:02, 846.71it/s] 46%|████▌     | 1644/3613 [00:01<00:02, 855.48it/s] 48%|████▊     | 1730/3613 [00:02<00:02, 806.10it/s] 50%|█████     | 1816/3613 [00:02<00:02, 818.78it/s] 53%|█████▎    | 1906/3613 [00:02<00:02, 839.49it/s] 55%|█████▌    | 1992/3613 [00:02<00:01, 844.81it/s] 57%|█████▋    | 2077/3613 [00:02<00:01, 808.93it/s] 60%|█████▉    | 2165/3613 [00:02<00:01, 827.07it/s] 62%|██████▏   | 2249/3613 [00:02<00:01, 817.21it/s] 65%|██████▍   | 2337/3613 [00:02<00:01, 832.87it/s] 67%|██████▋   | 2426/3613 [00:02<00:01, 849.26it/s] 70%|██████▉   | 2514/3613 [00:02<00:01, 857.89it/s] 72%|███████▏  | 2601/3613 [00:03<00:01, 860.59it/s] 74%|███████▍  | 2690/3613 [00:03<00:01, 867.18it/s] 77%|███████▋  | 2779/3613 [00:03<00:00, 872.49it/s] 79%|███████▉  | 2868/3613 [00:03<00:00, 875.79it/s] 82%|████████▏ | 2956/3613 [00:03<00:00, 876.25it/s] 84%|████████▍ | 3045/3613 [00:03<00:00, 878.37it/s] 87%|████████▋ | 3134/3613 [00:03<00:00, 879.77it/s] 89%|████████▉ | 3222/3613 [00:03<00:00, 877.35it/s] 92%|█████████▏| 3310/3613 [00:03<00:00, 862.23it/s] 94%|█████████▍| 3397/3613 [00:04<00:00, 854.05it/s] 96%|█████████▋| 3483/3613 [00:04<00:00, 798.85it/s] 99%|█████████▉| 3570/3613 [00:04<00:00, 818.16it/s]100%|██████████| 3613/3613 [00:04<00:00, 843.37it/s]
creating transformer data
  0%|          | 0/904 [00:00<?, ?it/s] 10%|▉         | 89/904 [00:00<00:00, 881.91it/s] 20%|█▉        | 178/904 [00:00<00:00, 882.31it/s] 30%|██▉       | 268/904 [00:00<00:00, 889.65it/s] 40%|███▉      | 358/904 [00:00<00:00, 893.49it/s] 50%|████▉     | 448/904 [00:00<00:00, 890.03it/s] 60%|█████▉    | 538/904 [00:00<00:00, 867.95it/s] 69%|██████▉   | 626/904 [00:00<00:00, 869.43it/s] 79%|███████▉  | 715/904 [00:00<00:00, 874.71it/s] 89%|████████▉ | 805/904 [00:00<00:00, 882.45it/s] 99%|█████████▉| 895/904 [00:01<00:00, 887.36it/s]100%|██████████| 904/904 [00:01<00:00, 882.52it/s]
Validation loss decreased (inf --> 0.066623).  Saving model ...
Epoch: 0, Val_rmse: 0.0666
EarlyStopping counter: 1 out of 30
Epoch: 1, Val_rmse: 0.0675
Validation loss decreased (0.066623 --> 0.063958).  Saving model ...
Epoch: 2, Val_rmse: 0.064
Validation loss decreased (0.063958 --> 0.063238).  Saving model ...
Epoch: 3, Val_rmse: 0.0632
Validation loss decreased (0.063238 --> 0.057996).  Saving model ...
Epoch: 4, Val_rmse: 0.058
Validation loss decreased (0.057996 --> 0.050582).  Saving model ...
Epoch: 5, Val_rmse: 0.0506
EarlyStopping counter: 1 out of 30
Epoch: 6, Val_rmse: 0.0535
Validation loss decreased (0.050582 --> 0.049150).  Saving model ...
Epoch: 7, Val_rmse: 0.0492
Validation loss decreased (0.049150 --> 0.047285).  Saving model ...
Epoch: 8, Val_rmse: 0.0473
EarlyStopping counter: 1 out of 30
Epoch: 9, Val_rmse: 0.0514
Validation loss decreased (0.047285 --> 0.047144).  Saving model ...
Epoch: 10, Val_rmse: 0.0471
EarlyStopping counter: 1 out of 30
Epoch: 11, Val_rmse: 0.0484
EarlyStopping counter: 2 out of 30
Epoch: 12, Val_rmse: 0.0476
Validation loss decreased (0.047144 --> 0.046815).  Saving model ...
Epoch: 13, Val_rmse: 0.0468
Validation loss decreased (0.046815 --> 0.046686).  Saving model ...
Epoch: 14, Val_rmse: 0.0467
EarlyStopping counter: 1 out of 30
Epoch: 15, Val_rmse: 0.0494
EarlyStopping counter: 2 out of 30
Epoch: 16, Val_rmse: 0.0486
EarlyStopping counter: 3 out of 30
Epoch: 17, Val_rmse: 0.0472
Validation loss decreased (0.046686 --> 0.046580).  Saving model ...
Epoch: 18, Val_rmse: 0.0466
Validation loss decreased (0.046580 --> 0.046419).  Saving model ...
Epoch: 19, Val_rmse: 0.0464
EarlyStopping counter: 1 out of 30
Epoch: 20, Val_rmse: 0.0479
EarlyStopping counter: 2 out of 30
Epoch: 21, Val_rmse: 0.0464
EarlyStopping counter: 3 out of 30
Epoch: 22, Val_rmse: 0.0474
EarlyStopping counter: 4 out of 30
Epoch: 23, Val_rmse: 0.0467
EarlyStopping counter: 5 out of 30
Epoch: 24, Val_rmse: 0.0484
EarlyStopping counter: 6 out of 30
Epoch: 25, Val_rmse: 0.0471
EarlyStopping counter: 7 out of 30
Epoch: 26, Val_rmse: 0.0478
EarlyStopping counter: 8 out of 30
Epoch: 27, Val_rmse: 0.0473
EarlyStopping counter: 9 out of 30
Epoch: 28, Val_rmse: 0.0482
EarlyStopping counter: 10 out of 30
Epoch: 29, Val_rmse: 0.0466
creating transformer data
  0%|          | 0/203 [00:00<?, ?it/s] 40%|███▉      | 81/203 [00:00<00:00, 804.68it/s] 83%|████████▎ | 168/203 [00:00<00:00, 840.57it/s]100%|██████████| 203/203 [00:00<00:00, 840.02it/s]
creating transformer data
  0%|          | 0/3613 [00:00<?, ?it/s]  2%|▏         | 64/3613 [00:00<00:05, 637.85it/s]  4%|▍         | 138/3613 [00:00<00:04, 695.55it/s]  6%|▌         | 217/3613 [00:00<00:04, 735.14it/s]  8%|▊         | 297/3613 [00:00<00:04, 759.16it/s] 10%|█         | 379/3613 [00:00<00:04, 778.70it/s] 13%|█▎        | 461/3613 [00:00<00:03, 792.19it/s] 15%|█▌        | 546/3613 [00:00<00:03, 808.00it/s] 17%|█▋        | 630/3613 [00:00<00:03, 815.35it/s] 20%|█▉        | 713/3613 [00:00<00:03, 819.41it/s] 22%|██▏       | 795/3613 [00:01<00:03, 816.48it/s] 24%|██▍       | 877/3613 [00:01<00:03, 803.50it/s] 27%|██▋       | 958/3613 [00:01<00:03, 765.36it/s] 29%|██▊       | 1035/3613 [00:01<00:03, 757.45it/s] 31%|███       | 1120/3613 [00:01<00:03, 781.80it/s] 33%|███▎      | 1200/3613 [00:01<00:03, 785.38it/s] 36%|███▌      | 1284/3613 [00:01<00:02, 798.75it/s] 38%|███▊      | 1368/3613 [00:01<00:02, 809.98it/s] 40%|████      | 1451/3613 [00:01<00:02, 813.90it/s] 42%|████▏     | 1535/3613 [00:01<00:02, 820.32it/s] 45%|████▍     | 1618/3613 [00:02<00:02, 819.89it/s] 47%|████▋     | 1701/3613 [00:02<00:02, 819.34it/s] 49%|████▉     | 1786/3613 [00:02<00:02, 825.45it/s] 52%|█████▏    | 1869/3613 [00:02<00:02, 823.49it/s] 54%|█████▍    | 1952/3613 [00:02<00:02, 821.24it/s] 56%|█████▋    | 2035/3613 [00:02<00:01, 813.28it/s] 59%|█████▊    | 2118/3613 [00:02<00:01, 815.88it/s] 61%|██████    | 2200/3613 [00:02<00:01, 815.43it/s] 63%|██████▎   | 2282/3613 [00:02<00:01, 800.66it/s] 65%|██████▌   | 2363/3613 [00:02<00:01, 783.41it/s] 68%|██████▊   | 2442/3613 [00:03<00:01, 783.33it/s] 70%|██████▉   | 2524/3613 [00:03<00:01, 791.85it/s] 72%|███████▏  | 2604/3613 [00:03<00:01, 771.86it/s] 74%|███████▍  | 2682/3613 [00:03<00:01, 762.48it/s] 76%|███████▋  | 2759/3613 [00:03<00:01, 751.98it/s] 79%|███████▊  | 2840/3613 [00:03<00:01, 766.79it/s] 81%|████████  | 2920/3613 [00:03<00:00, 773.90it/s] 83%|████████▎ | 3002/3613 [00:03<00:00, 786.93it/s] 85%|████████▌ | 3085/3613 [00:03<00:00, 798.95it/s] 88%|████████▊ | 3165/3613 [00:03<00:00, 797.59it/s] 90%|████████▉ | 3248/3613 [00:04<00:00, 806.29it/s] 92%|█████████▏| 3329/3613 [00:04<00:00, 621.87it/s] 94%|█████████▍| 3406/3613 [00:04<00:00, 656.19it/s] 97%|█████████▋| 3488/3613 [00:04<00:00, 697.45it/s] 99%|█████████▉| 3568/3613 [00:04<00:00, 723.93it/s]100%|██████████| 3613/3613 [00:04<00:00, 776.83it/s]
creating transformer data
  0%|          | 0/904 [00:00<?, ?it/s]  9%|▊         | 77/904 [00:00<00:01, 759.70it/s] 17%|█▋        | 155/904 [00:00<00:00, 766.44it/s] 26%|██▋       | 239/904 [00:00<00:00, 794.93it/s] 36%|███▌      | 323/904 [00:00<00:00, 809.67it/s] 45%|████▍     | 405/904 [00:00<00:00, 812.50it/s] 54%|█████▍    | 487/904 [00:00<00:00, 814.48it/s] 63%|██████▎   | 569/904 [00:00<00:00, 760.40it/s] 71%|███████▏  | 646/904 [00:00<00:00, 751.58it/s] 81%|████████  | 729/904 [00:00<00:00, 773.75it/s] 90%|████████▉ | 811/904 [00:01<00:00, 786.15it/s] 99%|█████████▉| 895/904 [00:01<00:00, 799.68it/s]100%|██████████| 904/904 [00:01<00:00, 788.78it/s]/Users/moon515/anaconda3/envs/CDRP/lib/python3.8/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
